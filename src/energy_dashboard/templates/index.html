<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Dashboard</title>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="https://unpkg.com/htmx.org@1.9.12/dist/ext/sse.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.12/dist/ext/client-side-templates.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <style>
        .dashboard {
            margin: 20px;
        }
        .box {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="notification is-primary">
            <h1 class="title">Energy Dashboard</h1>
            <p class="subtitle">Real-time Energy Data Updates</p>
        </div>
        <div hx-ext="client-side-templates">
            <div hx-ext="sse" sse-connect="/api/v1/stream" sse-swap="message">
                <div
                    sse-swap="message"
                    hx-swap="afterbegin"
                    hx-target="#energy-data-table"
                    mustache-template="dashboard-row"
                ></div>
            </div>
        </div>
        <table class="table is-fullwidth">
            <thead>
                <tr>
                    <th>Period</th>
                    <th>Respondent</th>
                    <th>Respondent Name</th>
                    <th>Type</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody id="energy-data-table">
                <!-- Table rows will be dynamically updated here -->
            </tbody>
        </table>
        <template id="dashboard-row">
            <tr id="id_{{respondent}}">
                <td>{{period}}</td>
                <td>{{respondent}}</td>
                <td>{{respondent_name}}</td>
                <td>{{type}}</td>
                <td>{{value}}</td>
            </tr>
        </template>
    </div>
</body>
</html>
